<!DOCTYPE html><html><head><title>Learn how to download message attachments from message store - C#- RingCentral Developer Tutorials</title><style>body, html {
  height:100%;
  width:100%;
  padding:0;
  margin:0;
  overflow:hidden;
  background-color:#ddd;
}
.wrapper {
  height:100%;
  width:100%;
}</style><link rel="shortcut icon" href="https://developers.ringcentral.com/assets/images/favicon.ico?v=20161209-1544"><link rel="apple-touch-icon" href="https://developers.ringcentral.com/assets/images/favicon.ico?v=20161209-1544"><link rel="apple-touch-icon" sizes="72x72" href="https://developers.ringcentral.com/assets/images/favicon.ico?v=20161209-1544"><link rel="apple-touch-icon" sizes="114x114" href="https://developers.ringcentral.com/assets/images/favicon.ico?v=20161209-1544"><link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css"><link rel="stylesheet" href="//cdn.jsdelivr.net/npm/jquery-ui@1.12.1/themes/base/all.css"><link rel="stylesheet" href="viewsaurus.css"></head><body><div class="wrapper"><div class="dpw-header-container"><div class="dpw-header center-section"><div class="logo"><a href="https://developers.ringcentral.com" class="logo-link"></a></div><div class="nav-top-menus"></div><div class="dpw-login-section"><a href="https://developer.ringcentral.com/login.html#/">Sign in | Sign up</a></div></div></div><div id="viewsaurus" data-title="Learn how to download message attachments from message store - C#"><div class="saurus-panes"><div class="saurus-panes-header"><a href="https://ringcentral.github.io/tutorials/" class="saurus-back-to-tutorials">Tutorials</a><span>&gt;</span><span>Learn how to download message attachments from message store - C#</span></div><div class="saurus-prose"><div class="saurus-nav-buttons"><div class="saurus-nav-button nav-overview"><div class="saurus-nav-button-inner"><i class="fa fa-fw icon-menu"></i></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-previous"><div class="saurus-nav-button-inner"><a href=""> <i class="fa fa-fw fa-play fa-rotate-180"></i></a></div><div class="nav-divider"></div></div><div class="saurus-nav-button nav-next clickable"><div class="saurus-nav-button-inner"><a href="#1"> <i class="fa fa-fw fa-play"></i></a></div></div><div class="saurus-next-title"><span class="next-title-inner"></span></div></div><div class="saurus-progress-bar"></div><div class="saurus-start"><p>A tutorial to teach you how to download message attachments from user's message store. Click the &quot;Start&quot; button below to start the tutorial.</p><a href="#0">Start Tutorial</a></div><div class="saurus-content"><div data-title="Download Message Attachment Tutorial" class="chapter"><div data-title="Clone and Setup the project" data-file="../README.md" data-highlight="12-15" class="step"><h3 id="clone-and-setup-the-project">Clone and Setup the project</h3>
<p>Clone the project from GitHub and open it using Microsoft Visual Studio IDE.</p>
</div><div data-title="Create a RingCentral app" data-file="../README.md" data-highlight="18-21" class="step"><h3 id="create-a-ringcentral-app">Create a RingCentral app</h3>
<p>If you don&#39;t know how to create a RingCentral app. Click <a href="https://developer.ringcentral.com/library/getting-started.html">https://developer.ringcentral.com/library/getting-started.html</a> for instructions.</p>
</div><div data-title="Set Environment Variables" data-file="../message-store-download-content-csharp-demo/Program.cs" data-highlight="11-17" class="step"><h3 id="set-variables">Set Variables</h3>
<p>Copy the Client id and Client secret and specify them in following the parameters accordingly.</p>
<pre><code>const string RINGCENTRAL_CLIENTID = &quot;Your_App_Client_Id&quot;;
const string RINGCENTRAL_CLIENTSECRET = &quot;Your_App_Client_Secret&quot;;
const bool RINGCENTRAL_PRODUCTION = false;
</code></pre><p>Enter the account login credentials to the following variables.</p>
<pre><code>const string RINGCENTRAL_USERNAME = &quot;Your_Account_Username&quot;;
const string RINGCENTRAL_PASSWORD = &quot;Your_Account_Password&quot;;
const string RINGCENTRAL_EXTENSION = &quot;&quot;;
</code></pre><p>If you want to run the app on your production account, copy app and login credentials for your production environment and change the following variable value to true.</p>
<pre><code>const bool RINGCENTRAL_PRODUCTION = true;
</code></pre></div><div data-title="Login the platform" data-file="../message-store-download-content-csharp-demo/Program.cs" data-highlight="25-27" class="step"><h3 id="login-using-ringcentral-net-sdk">Login using RingCentral .Net SDK</h3>
<p>Using a RingCentral SDK is the most convenient way to authenticate and access RingCentral platform services.</p>
<p>To login RingCentral platform, we call the <strong>rc.Authorize()</strong> function, passing along the username, extension number (optional) and the password.</p>
<p>Then we check if we have got the access token to make sure we have logged in successfully.</p>
</div><div data-title="Specify message store query parameters" data-file="../message-store-download-content-csharp-demo/Program.cs" data-highlight="29-31" class="step"><h3 id="specify-message-store-query-parameters">Specify message store query parameters</h3>
<p>To call the &quot;message-store&quot; endpoint we specify the time period using the <strong>dateFrom</strong> and <strong>dateTo</strong> query parameters.</p>
<p>You can specify other query parameters such as <strong>messageType</strong>, <strong>direction</strong> etc. if you want.</p>
</div><div data-title="Get ready to save message attachments" data-file="../message-store-download-content-csharp-demo/Program.cs" data-highlight="32-36" class="step"><h3 id="get-ready-to-save-message-attachments">Get ready to save message attachments</h3>
<p>We create a &quot;content&quot; folder to store message attachments.</p>
<p>To get ready for downloading a big amount of attachments, we need to limit API calls to meet the &quot;Usage Plan Group&quot; requirement to avoid exceeding API rate limit. For this API endpoint, it is 40 API calls per minute.
For that purpose, we use the <strong>timePerApiCall</strong> variable to cause a delay between API calls.</p>
</div><div data-title="Read the user message store" data-file="../message-store-download-content-csharp-demo/Program.cs" data-highlight="37-38" class="step"><h3 id="read-the-user-message-store">Read the user message store</h3>
<p>We call the <strong>MessageStore().List()</strong> function to read the messages metadata.</p>
<p>Then we use a foreach loop to iterate through the <strong>records</strong> array.</p>
</div><div data-title="Detect the message type" data-file="../message-store-download-content-csharp-demo/Program.cs" data-highlight="42-72" class="step"><h3 id="detect-the-message-type">Detect the message type</h3>
<p>Each record may contain several attachments. We iterate through the attachments array, detect the message type to create a file name and file name extension accordingly.</p>
<p>We implement the <strong>getFileExtensionFromMimeType()</strong> function to specify the filename extension based on the attachment <strong>contentType</strong>.</p>
</div><div data-title="Download the message attachment" data-file="../message-store-download-content-csharp-demo/Program.cs" data-highlight="73-80" class="step"><h3 id="download-the-message-attachment">Download the message attachment</h3>
<p>We download the attachment identified by the <strong>attachment.id</strong>.</p>
<p>Finally, we read the data then save the data to a file under the <strong>content</strong> folder.</p>
</div><div data-title="Read the next attachment" data-file="../message-store-download-content-csharp-demo/Program.cs" data-highlight="81-86" class="step"><h3 id="cause-delay-and-read-the-next-attachment">Cause delay and read the next attachment</h3>
<p>We calculate the <strong>consumed</strong> time it took to read and save an attachment, and cause a delay if the <strong>consumed</strong> time is less than the <strong>timePerApiCall</strong>. Otherwise, we move on to download the next attachment.</p>
</div></div>
<div class="saurus-files" style="display:none;"><textarea class="saurus-file" data-file="../README.md" data-mode="markdown">IyMjIE92ZXJ2aWV3ClRoaXMgdHV0b3JpYWwgcHJvamVjdCBzaG93cyB5b3UgaG93IHRvIGRvd25sb2FkIHVzZXIncyBtZXNzYWdlIGF0dGFjaG1lbnRzIGFuZCBzYXZlIHRoZW0gdG8gYSBsb2NhbCBtYWNoaW5lLgoKIyMjIFJpbmdDZW50cmFsIENvbm5lY3QgUGxhdGZvcm0KUmluZ0NlbnRyYWwgRGV2ZWxvcGVyIFBsYXRmb3JtIGlzIGEgcmljaCBSRVNUZnVsIEFQSSBwbGF0Zm9ybSB3aXRoIG1vcmUgdGhhbiA3MCBBUElzIGZvciBidXNpbmVzcyBjb21tdW5pY2F0aW9uIGluY2x1ZGVzIGFkdmFuY2VkIHZvaWNlIGNhbGxzLCBjaGF0IG1lc3NhZ2luZywgU01TL01NUyBhbmQgRmF4LgoKIyMjIFJpbmdDZW50cmFsIERldmVsb3BlciBQb3J0YWwKVG8gc2V0dXAgYSBmcmVlIGRldmVsb3BlciBhY2NvdW50LCBjbGljayBbaHR0cHM6Ly9kZXZlbG9wZXIvcmluZ2NlbnRyYWwuY29tXShoZXJlKQoKIyMjIENsb25lIC0gU2V0dXAgLSBSdW4gdGhlIHByb2plY3QKYGBgCiQgZ2l0IGNsb25lIGh0dHBzOi8vZ2l0aHViLmNvbS9yaW5nY2VudHJhbC10dXRvcmlhbHMvbWVzc2FnZS1zdG9yZS1kb3dubG9hZC1jb250ZW50LWNzaGFycC1kZW1vCmBgYAoKT3BlbiB0aGUgIm1lc3NhZ2Utc3RvcmUtZG93bmxvYWQtY29udGVudC1jc2hhcnAtZGVtby5zbG4iIHByb2plY3Qgd2l0aCBNaWNyb3NvZnQgVmlzdWFsIFN0dWRpbyBJREUuCgojIyMgQ3JlYXRlIGFuIGFwcAoqIENyZWF0ZSBhbiBhcHBsaWNhdGlvbiBhdCBodHRwczovL2RldmVsb3Blci5yaW5nY2VudHJhbC5jb20uCiogU2VsZWN0IGBTZXJ2ZXItb25seSAoTm8gVUkpYCBmb3IgdGhlIFBsYXRmb3JtIHR5cGUuCiogQWRkIHRoZSBgUmVhZE1lc3NhZ2VzYCBwZXJtaXNzaW9uIGZvciB0aGUgYXBwLgoqIENvcHkgdGhlIENsaWVudCBpZCBhbmQgQ2xpZW50IHNlY3JldCBhbmQgYWRkIHRoZW0gdG8gdGhlIGBQcm9ncmFtLmNzYCBmaWxlLgpgYGAKUklOR0NFTlRSQUxfQ0xJRU5USUQ9UklOR0NFTlRSQUxfQ0xJRU5UU0VDUkVUPQpgYGAKKiBBZGQgdGhlIGFjY291bnQgbG9naW4gY3JlZGVudGlhbHMgdG8gdGhlIGBQcm9ncmFtLmNzYCBmaWxlLgpgYGAKUklOR0NFTlRSQUxfVVNFUk5BTUU9ClJJTkdDRU5UUkFMX1BBU1NXT1JEPQpSSU5HQ0VOVFJBTF9FWFRFTlNJT049CmBgYAoKIyMjIE1ha2Ugc3VyZSB5b3UgaGF2ZSBzb21lIGNvbnRlbnQKKiBMb2dpbiB5b3VyIFJpbmdDZW50cmFsIGFjY291bnQgZnJvbSBSaW5nQ2VudHJhbCBzb2Z0LXBob25lLgoqIFNlbmQgYSBmZXcgTU1TIG1lc3NhZ2UgdG8geW91ciBSaW5nQ2VudHJhbCBudW1iZXIuCiogTWFrZSBhIGZldyBwaG9uZSBjYWxscyB0byB5b3VyIFJpbmdDZW50cmFsIG51bWJlciBhbmQgbGVhdmUgdm9pY2UgbWVzc2FnZXMuCiogU2VuZCBhIGZldyBmYXggbWVzc2FnZXMgdG8geW91ciBSaW5nQ2VudHJhbCBudW1iZXIuCgojIyMgUnVuIHRoZSBkZW1vClJ1biB0aGUgZGVtbyBhcHAgZnJvbSBWaXN1YWwgU3R1ZGlvCgojIyMgUmluZ0NlbnRyYWwgRGV2ZWxvcGVyIFBvcnRhbApUbyBzZXR1cCBhIGZyZWUgZGV2ZWxvcGVyIGFjY291bnQsIGNsaWNrIFtoZXJlXShodHRwczovL2RldmVsb3Blci9yaW5nY2VudHJhbC5jb20pCgojIyBSaW5nQ2VudHJhbCAuTmV0IFNESwpUaGUgU0RLIGlzIGF2YWlsYWJsZSBhdCBodHRwczovL2dpdGh1Yi5jb20vcmluZ2NlbnRyYWwvcmluZ2NlbnRyYWwubmV0Cg==</textarea>
<textarea class="saurus-file" data-file="../message-store-download-content-csharp-demo/Program.cs" data-mode="csharp">77u/dXNpbmcgU3lzdGVtOwp1c2luZyBTeXN0ZW0uSU87CnVzaW5nIFN5c3RlbS5UaHJlYWRpbmc7CnVzaW5nIFN5c3RlbS5UaHJlYWRpbmcuVGFza3M7CnVzaW5nIFJpbmdDZW50cmFsOwoKbmFtZXNwYWNlIGRvd25sb2FkX2NvbnRlbnQKewogICAgY2xhc3MgTWFpbkNsYXNzCiAgICB7CiAgICAgICAgY29uc3Qgc3RyaW5nIFJJTkdDRU5UUkFMX0NMSUVOVElEID0gIllvdXJfQXBwX0NsaWVudF9JZCI7CiAgICAgICAgY29uc3Qgc3RyaW5nIFJJTkdDRU5UUkFMX0NMSUVOVFNFQ1JFVCA9ICJZb3VyX0FwcF9DbGllbnRfU2VjcmV0IjsKICAgICAgICBjb25zdCBib29sIFJJTkdDRU5UUkFMX1BST0RVQ1RJT04gPSBmYWxzZTsKCiAgICAgICAgY29uc3Qgc3RyaW5nIFJJTkdDRU5UUkFMX1VTRVJOQU1FID0gIllvdXJfQWNjb3VudF9Vc2VybmFtZSI7CiAgICAgICAgY29uc3Qgc3RyaW5nIFJJTkdDRU5UUkFMX1BBU1NXT1JEID0gIllvdXJfQWNjb3VudF9QYXNzd29yZCI7CiAgICAgICAgY29uc3Qgc3RyaW5nIFJJTkdDRU5UUkFMX0VYVEVOU0lPTiA9ICIiOwoKICAgICAgICBwdWJsaWMgc3RhdGljIHZvaWQgTWFpbihzdHJpbmdbXSBhcmdzKQogICAgICAgIHsKICAgICAgICAgICAgcmVhZF9tZXNzYWdlX3N0b3JlX21lc3NhZ2VfY29udGVudCgpLldhaXQoKTsKICAgICAgICB9CiAgICAgICAgc3RhdGljIHByaXZhdGUgYXN5bmMgVGFzayByZWFkX21lc3NhZ2Vfc3RvcmVfbWVzc2FnZV9jb250ZW50KCkKICAgICAgICB7CiAgICAgICAgICAgIFJlc3RDbGllbnQgcmMgPSBuZXcgUmVzdENsaWVudChSSU5HQ0VOVFJBTF9DTElFTlRJRCwgUklOR0NFTlRSQUxfQ0xJRU5UU0VDUkVULCBSSU5HQ0VOVFJBTF9QUk9EVUNUSU9OKTsKICAgICAgICAgICAgYXdhaXQgcmMuQXV0aG9yaXplKFJJTkdDRU5UUkFMX1VTRVJOQU1FLCBSSU5HQ0VOVFJBTF9FWFRFTlNJT04sIFJJTkdDRU5UUkFMX1BBU1NXT1JEKTsKICAgICAgICAgICAgaWYgKHJjLnRva2VuLmFjY2Vzc190b2tlbi5MZW5ndGggPiAwKQogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICB2YXIgcGFyYW1ldGVycyA9IG5ldyBMaXN0TWVzc2FnZXNQYXJhbWV0ZXJzKCk7CiAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzLmRhdGVGcm9tID0gIjIwMTktMDEtMDFUMDA6MDA6MDAuMDAwWiI7CiAgICAgICAgICAgICAgICBwYXJhbWV0ZXJzLmRhdGVUbyA9ICIyMDE5LTAzLTMxVDIzOjU5OjU5Ljk5OVoiOwogICAgICAgICAgICAgICAgdmFyIGNvbnRlbnRQYXRoID0gImNvbnRlbnQvIjsKICAgICAgICAgICAgICAgIGlmICghRGlyZWN0b3J5LkV4aXN0cyhjb250ZW50UGF0aCkpCiAgICAgICAgICAgICAgICAgICAgU3lzdGVtLklPLkRpcmVjdG9yeS5DcmVhdGVEaXJlY3RvcnkoY29udGVudFBhdGgpOwogICAgICAgICAgICAgICAgLy8gTGltaXQgQVBJIGNhbGwgdG8gfjQwIGNhbGxzIHBlciBtaW51dGUgdG8gYXZvaWQgZXhjZWVkaW5nIEFQSSByYXRlIGxpbWl0LgogICAgICAgICAgICAgICAgbG9uZyB0aW1lUGVyQXBpQ2FsbCA9IDEyMDA7CiAgICAgICAgICAgICAgICB2YXIgcmVzcCA9IGF3YWl0IHJjLlJlc3RhcGkoKS5BY2NvdW50KCkuRXh0ZW5zaW9uKCkuTWVzc2FnZVN0b3JlKCkuTGlzdChwYXJhbWV0ZXJzKTsKICAgICAgICAgICAgICAgIGZvcmVhY2ggKHZhciByZWNvcmQgaW4gcmVzcC5yZWNvcmRzKQogICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgIGlmIChyZWNvcmQuYXR0YWNobWVudHMgIT0gbnVsbCkKICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvcmVhY2ggKHZhciBhdHRhY2htZW50IGluIHJlY29yZC5hdHRhY2htZW50cykKICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGZpbGVOYW1lID0gIiI7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmlsZUV4dCA9IGdldEZpbGVFeHRlbnNpb25Gcm9tTWltZVR5cGUoYXR0YWNobWVudC5jb250ZW50VHlwZSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVjb3JkLnR5cGUgPT0gIlZvaWNlTWFpbCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGF0dGFjaG1lbnQudHlwZSA9PSAiQXVkaW9SZWNvcmRpbmciKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZU5hbWUgPSBTdHJpbmcuRm9ybWF0KCJ2b2ljZW1haWxfcmVjb3JkaW5nX3swfXsxfSIsIHJlY29yZC5hdHRhY2htZW50c1swXS5pZCwgZmlsZUV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGF0dGFjaG1lbnQudHlwZSA9PSAiQXVkaW9UcmFuc2NyaXB0aW9uIiAmJgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlY29yZC52bVRyYW5zY3JpcHRpb25TdGF0dXMgPT0gIkNvbXBsZXRlZCIpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmaWxlTmFtZSA9IFN0cmluZy5Gb3JtYXQoInZvaWNlbWFpbF90cmFuc2NyaXB0X3swfS50eHQiLCByZWNvcmQuYXR0YWNobWVudHNbMF0uaWQpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKHJlY29yZC50eXBlID09ICJGYXgiKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVOYW1lID0gU3RyaW5nLkZvcm1hdCgiZmF4X2F0dGFjaG1lbnRfezB9ezF9IiwgYXR0YWNobWVudC5pZCwgZmlsZUV4dCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChyZWNvcmQudHlwZSA9PSAiU01TIikKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoYXR0YWNobWVudC50eXBlID09ICJNbXNBdHRhY2htZW50IikKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVOYW1lID0gU3RyaW5nLkZvcm1hdCgibW1zX2F0dGFjaG1lbnRfezB9ezF9IiwgcmVjb3JkLmF0dGFjaG1lbnRzWzBdLmlkLCBmaWxlRXh0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZWxzZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZmlsZU5hbWUgPSBTdHJpbmcuRm9ybWF0KCJzbXNfdGV4dF97MH0udHh0IiwgcmVjb3JkLmF0dGFjaG1lbnRzWzBdLmlkKTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgcmVzID0gYXdhaXQgcmMuUmVzdGFwaSgpLkFjY291bnQoKS5FeHRlbnNpb24oKS5NZXNzYWdlU3RvcmUocmVjb3JkLmlkKS5Db250ZW50KGF0dGFjaG1lbnQuaWQpLkdldCgpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHN0YXJ0ID0gbmV3IERhdGVUaW1lT2Zmc2V0KERhdGVUaW1lLlV0Y05vdykuVG9Vbml4VGltZU1pbGxpc2Vjb25kcygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdXNpbmcgKEJpbmFyeVdyaXRlciB3cml0ZXIgPSBuZXcgQmluYXJ5V3JpdGVyKFN5c3RlbS5JTy5GaWxlLk9wZW4oY29udGVudFBhdGggKyBmaWxlTmFtZSwgRmlsZU1vZGUuQ3JlYXRlKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVyLldyaXRlKHJlcyk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVyLkZsdXNoKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgd3JpdGVyLkNsb3NlKCk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZW5kID0gbmV3IERhdGVUaW1lT2Zmc2V0KERhdGVUaW1lLlV0Y05vdykuVG9Vbml4VGltZU1pbGxpc2Vjb25kcygpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGNvbnN1bWVkID0gKGVuZCAtIHN0YXJ0KTsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChjb25zdW1lZCA8IHRpbWVQZXJBcGlDYWxsKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFRocmVhZC5TbGVlcCgoaW50KSh0aW1lUGVyQXBpQ2FsbCAtIGNvbnN1bWVkKSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcHJpdmF0ZSBzdGF0aWMgc3RyaW5nIGdldEZpbGVFeHRlbnNpb25Gcm9tTWltZVR5cGUoc3RyaW5nIG1pbWVUeXBlKQogICAgICAgIHsKICAgICAgICAgICAgc3dpdGNoIChtaW1lVHlwZSkKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgY2FzZSAidGV4dC9odG1sIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gImh0bWwiOwogICAgICAgICAgICAgICAgY2FzZSAidGV4dC9jc3MiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAiLmNzcyI7CiAgICAgICAgICAgICAgICBjYXNlICJ0ZXh0L3htbCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIueG1sIjsKICAgICAgICAgICAgICAgIGNhc2UgInRleHQvcGxhaW4iOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAiLnR4dCI7CiAgICAgICAgICAgICAgICBjYXNlICJ0ZXh0L3gtdmNhcmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAiLnZjZiI7CiAgICAgICAgICAgICAgICBjYXNlICJhcHBsaWNhdGlvbi9tc3dvcmQiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAiLmRvYyI7CiAgICAgICAgICAgICAgICBjYXNlICJhcHBsaWNhdGlvbi9wZGYiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAiLnBkZiI7CiAgICAgICAgICAgICAgICBjYXNlICJhcHBsaWNhdGlvbi9ydGYiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAiLnJ0ZiI7CiAgICAgICAgICAgICAgICBjYXNlICJhcHBsaWNhdGlvbi92bmQubXMtZXhjZWwiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAiLnhscyI7CiAgICAgICAgICAgICAgICBjYXNlICJhcHBsaWNhdGlvbi92bmQubXMtcG93ZXJwb2ludCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIucHB0IjsKICAgICAgICAgICAgICAgIGNhc2UgImFwcGxpY2F0aW9uL3ppcCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIuemlwIjsKICAgICAgICAgICAgICAgIGNhc2UgImltYWdlL3RpZmYiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAiLnRpZmYiOwogICAgICAgICAgICAgICAgY2FzZSAiaW1hZ2UvZ2lmIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIi5naWYiOwogICAgICAgICAgICAgICAgY2FzZSAiaW1hZ2UvanBlZyI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIuanBnIjsKICAgICAgICAgICAgICAgIGNhc2UgImltYWdlL3BuZyI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIucG5nIjsKICAgICAgICAgICAgICAgIGNhc2UgImltYWdlL3gtbXMtYm1wIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIi5ibXAiOwogICAgICAgICAgICAgICAgY2FzZSAiaW1hZ2Uvc3ZnK3htbCI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIuc3ZnIjsKICAgICAgICAgICAgICAgIGNhc2UgImF1ZGlvL3dhdiI6CiAgICAgICAgICAgICAgICBjYXNlICJhdWRpby94LXdhdiI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIud2F2IjsKICAgICAgICAgICAgICAgIGNhc2UgImF1ZGlvL21wZWciOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAiLm1wMyI7CiAgICAgICAgICAgICAgICBjYXNlICJhdWRpby9vZ2ciOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAiLm9nZyI7CiAgICAgICAgICAgICAgICBjYXNlICJ2aWRlby8zZ3BwIjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIi4zZ3AiOwogICAgICAgICAgICAgICAgY2FzZSAidmlkZW8vbXBlZyI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIubXBlZyI7CiAgICAgICAgICAgICAgICBjYXNlICJ2aWRlby9xdWlja3RpbWUiOgogICAgICAgICAgICAgICAgICAgIHJldHVybiAiLm1vdiI7CiAgICAgICAgICAgICAgICBjYXNlICJ2aWRlby94LWZsdiI6CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICIuZmx2IjsKICAgICAgICAgICAgICAgIGNhc2UgInZpZGVvL3gtbXMtd212IjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIi53bXYiOwogICAgICAgICAgICAgICAgY2FzZSAidmlkZW8vbXA0IjoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIi5tcDQiOwogICAgICAgICAgICAgICAgZGVmYXVsdDoKICAgICAgICAgICAgICAgICAgICByZXR1cm4gIi51bmtub3duIjsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQo=</textarea>
</div>
</div><div class="saurus-overview"><ul></ul></div></div><div class="saurus-code"><div class="file-path"><span class="crumb-container"></span><i class="fa fa-fw fa-folder"></i></div><div class="saurus-editor"></div></div><div class="saurus-explorer"><div class="saurus-file-list"></div><div class="saurus-file-actions"><a href="https://github.com/ringcentral-tutorials/message-store-download-content-csharp-demo" target="_blank" class="explorer-get-code"><i class="fa fa-lg fa-github-square"></i>View Code on GitHub</a><a href="https://github.com/ringcentral-tutorials/message-store-download-content-csharp-demo/archive/master.zip" target="_blank" class="explorer-get-code"><i class="fa fa-lg icon-download"></i>Download Source Code</a></div></div></div></div><footer><div class="footer-content"><div class="footer-content-row layout-2-cols"><div class="footer-content-row-left"><div class="footer-logo"><a href="http://www.ringcentral.com"><span>Back to the main site</span></a></div></div><div class="footer-content-row-right"><ul class="footer-text-links"><li><a href="http://www.ringcentral.com/legal.html" target="_blank"><span>Legal</span></a></li><li><a href="http://www.ringcentral.com/security-statement.html" target="_blank"><span>Security Policy</span></a></li><li><a href="http://www.ringcentral.com/legal/privacy-policy.html" target="_blank"><span>Privacy Policy</span></a></li><li><a ng-href="https://devcommunity.ringcentral.com" target="_blank" href="https://devcommunity.ringcentral.com"><span>Community</span></a></li><li><a href="https://medium.com/ringcentral-developers" target="_blank"><span>Blog</span></a></li></ul></div></div><div class="footer-content-row footer-content-row-last layout-2-cols"><div class="footer-content-row-left"><span class="footer-copyright">Â© 1999-<span ng-bind="::main.nowObj|date:'yyyy'" class="footer-copyright-to ng-binding">2017</span> RingCentral, Inc. All rights reserved.</span></div><div class="footer-content-row-right"><div class="footer-image-links"><div class="footer-image-link footer-image-link-facebook"><a target="_blank" href="http://www.facebook.com/ringcentral"><i class="fa icon-facebook"></i></a></div><div class="footer-image-link footer-image-link-twitter"><a target="_blank" href="http://twitter.com/ringcentraldevs"><i class="fa icon-twitter"></i></a></div><div class="footer-image-link footer-image-link-google-plus"><a target="_blank" href="https://www.google.com/+ringcentral"><i class="fa icon-google_plus"></i></a></div><div class="footer-image-link footer-image-link-linkedin"><a target="_blank" href="http://www.linkedin.com/company/ringcentral"><i class="fa icon-linkedin"></i></a></div><div class="footer-image-link footer-image-link-youtube"><a target="_blank" href="http://www.youtube.com/ringcentral"><i class="fa icon-youtube"></i></a></div></div></div></div></div></footer></div><script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script><script src="//cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script><script src="ace/ace.js"></script><script src="ace/theme-monokai.js"></script><script src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script><script>window.tutorialName="Learn how to download message attachments from message store - C#";</script><script src="viewsaurus.js"></script></body></html>